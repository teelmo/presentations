/*1337563841,169775814*/

if (window.CavalryLogger) { CavalryLogger.start_js(["oW\/FK"]); }

__d("Live",["Arbiter","AsyncDOM","AsyncSignal","ChannelConstants","DOM","DataStore","createArrayFrom","LiveEnvironment"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('AsyncDOM'),i=b('AsyncSignal'),j=b('ChannelConstants'),k=b('DOM'),l=b('DataStore'),m=c('LiveEnvironment'),n=b('createArrayFrom'),o={logAll:false,startup:function(){o.startup=bagofholding;g.subscribe(j.getArbiterType('live'),o.handleMessage.bind(o));},lookupLiveNode:function(p,q){var r=k.scry(document.body,'.live_'+p+'_'+q);r.forEach(function(s){if(l.get(s,'seqnum')===undefined){var t=JSON.parse(s.getAttribute('data-live'));l.set(s,'seqnum',t.seq);}});return r;},handleMessage:function(p,q){var r=q.obj,s=r.fbid,t=r.assoc;if(r.hash)if(m.hash!==r.hash){o.log('wrongversion',r.hash,m.hash);return false;}var u=this.lookupLiveNode(s,t);if(!u)return false;u.forEach(function(v){if(r.expseq){var w=l.get(v,'seqnum'),x=l.get(v,'message_buffer');if(x===undefined){x={};l.set(v,'message_buffer',x);}var y={obj:r};x[r.expseq]=y;if(r.expseq!=w){o.log('mismatch',r.fbid,r.expseq,w);return false;}while(true){w=l.get(v,'seqnum');var z=x[w];if(z){h.invoke(z.obj.updates,v);o.log('seqmatch',r.fbid,'exp',r.expseq,'cur',w);delete x[w];}else break;}}else h.invoke(r.updates,v);});},log:function(){if(o.logAll){var p=n(arguments).join(':');new i('/common/scribe_endpoint.php',{c:'live_sequence',m:p}).send();}}};e.exports=o;});
__d("legacy:live-js",["Live"],function(a,b,c,d){a.Live=b('Live');},3);