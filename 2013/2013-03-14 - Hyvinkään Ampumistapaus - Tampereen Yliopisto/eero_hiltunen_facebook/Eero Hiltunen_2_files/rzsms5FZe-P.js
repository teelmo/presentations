/*1337656843,176833978*/

if (window.CavalryLogger) { CavalryLogger.start_js(["xCRLh"]); }

GroupMall={init:function(a){this._mallNode=$('group_mall_'+a);this._composerPublishToken=Arbiter.subscribe('composer/publish',function(event,b){if(b.streamStory&&!ge(b.streamStory.id))this._addPostToUI(b.streamStory);}.bind(this));onleaveRegister(this._onleave.bind(this));this._navigationBeginToken=Arbiter.subscribe(NavigationMessage.NAVIGATION_BEGIN,this._onleave.bind(this));},_onleave:function(){this._navigationBeginToken.unsubscribe();this._composerPublishToken.unsubscribe();},_addPostToUI:function(a){var b=Vector2.getElementDimensions(this._mallNode).y;DOM.prependContent(this._mallNode,a);var c=this._mallNode.firstChild;LiveTimer.startLoop(0);new animation(c).from('opacity',0).to('opacity',1).duration(300).go();}};
function GroupsMemberCountUpdater(){}GroupsMemberCountUpdater.subscribe=function(a){Arbiter.subscribe('GroupsMemberCount/change',function(b,c){var d=tx._("{count} j\u00e4sent\u00e4",{count:c});if(c==1)d=tx._("{count} j\u00e4sen",{count:c});DOM.setContent(a,d);});};
__d("GroupsAddTypeaheadView",["Arbiter","Class","ContextualTypeaheadView","copyProperties","tx"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('Class'),i=b('ContextualTypeaheadView'),j=b('copyProperties'),k=b('tx');function l(m,n){this.parent.construct(this,m,n);}h.extend(l,i);j(l.prototype,{render:function(m,n,o){for(var p=0;p<n.length;p++)if(n[p].is_member){n[p].type='member';n[p].subtext=null;n[p].category="Olet jo j\u00e4sen";}return this.parent.render(m,n,o);},select:function(m){var n=this.results[this.index];g.inform('GroupsMemberSuggestion/remove',n.uid);if(n.is_member)return;this.parent.select(m);}});e.exports=l;});
function GroupsAddMemberTypeahead(){}copy_properties(GroupsAddMemberTypeahead.prototype,{init:function(a,b){a.subscribe('select',function(c,d){Arbiter.inform('GroupsAddMemberTypeahead/add',{gid:b,uid:d.selected.uid,name:d.selected.text,photo:d.selected.photo});var e=a.getData().getExclusions();e.push(d.selected.uid);a.getData().setExclusions(e);});Arbiter.subscribe('GroupsAddMemberTypeahead/updateGroupToken',this.resetTypeaheadCaches.bind(this));},resetTypeaheadCaches:function(a,b){var c=DOM.scry(ge('pagelet_group_mall'),'.uiTypeahead');for(var d=0;d<c.length;d++){var e=Typeahead.getInstance(c[d]);if(e){var f=e.getData();f.updateToken(b.token);e.getCore().subscribe('focus',f.bootstrap.bind(f));}}}});
__d("legacy:Hovercard",["Hovercard"],function(a,b,c,d){a.Hovercard=b('Hovercard');},3);
__d("ChatController",["ChatTabModel","MercuryThreads"],function(a,b,c,d,e,f){var g=b('ChatTabModel'),h=b('MercuryThreads'),i={closeGroupTab:function(j,k){var l='group:'+j;g.closeTab(l,k||'chat_controller');},raiseFragileGroupTab:function(j){this.openFragileGroupTab(j);},openFragileGroupTab:function(j){h.getCanonicalThreadToGroup(j,function(k){if(k.is_subscribed)g.openFragileTab(k.thread_id);});},raiseGroupTab:function(j){h.getCanonicalThreadToGroup(j,function(k){if(k.is_subscribed)g.raiseAndPromoteTab(k.thread_id);});}};e.exports=i;});
__d("TypeaheadSubmitOnSelect",["copyProperties","Form"],function(a,b,c,d,e,f){var g=b('copyProperties'),h=b('Form');function i(j){this._typeahead=j;}g(i.prototype,{_subscription:null,enable:function(){this._subscription=this._typeahead.subscribe('select',function(){var j=this._typeahead.getCore().getElement().form;if(j)j.getAttribute('rel')=='async'?h.bootstrap(j):j.submit();}.bind(this));},disable:function(){this._typeahead.unsubscribe(this._subscription);this._subscription=null;}});e.exports=i;});
__d("legacy:SubmitOnSelectTypeaheadBehavior",["TypeaheadSubmitOnSelect"],function(a,b,c,d){var e=b('TypeaheadSubmitOnSelect');if(!a.TypeaheadBehaviors)a.TypeaheadBehaviors={};a.TypeaheadBehaviors.submitOnSelect=function(f){f.enableBehavior(e);};},3);
var TimelineFriendsTabHeader={init:function(a,b,c,d){this.header=a;this.count=b;this.subheader=DOM.find(a,'span.subheader');this.typeahead=c;this.selector=d;this.selector.subscribe('changeTarget',function(e,f){if(!this.header.disabled)this.updateFilter(f.value);}.bind(this));this.typeahead.subscribe('respond',function(e,f){if(!this.header.disabled)this.updateHeader(f.value,f.results,f.isAsync);}.bind(this));},setSubHeader:function(a){if(a){DOM.setContent(this.subheader,a);CSS.show(this.subheader);CSS.hide(this.count);}else{CSS.hide(this.subheader);CSS.show(this.count);}},updateHeader:function(a,b){var c;if(!a){c=null;}else if(!b||!b.length){c="Haku (ei tuloksia)";}else if(b.length==1){c="Haku (1 tulos)";}else c=tx._("Haku ({count} tulosta)",{count:b.length});this.setSubHeader(c);},updateFilter:function(a){var b;if(a){if(a=='Mutual Friends'){b="Yhteiset";}else if(a=='People You May Know'){b="Ihmisi\u00e4, jotka saatat tuntea";}else if(a=='friends_of'){b="Etsi kavereita";}else if(a=='currentcity'){b="Hae nykyisen paikkakunnan perusteella";}else if(a=='school'){b="Etsi koulun perusteella";}else if(a=='workplace'){b="Etsi ty\u00f6paikan perusteella";}else if(a=='hometown'){b="Hae kotikaupungin perusteella";}else if(a=='interest'){b="Hae kiinnostuksen kohteiden perusteella";}else b=null;this.setSubHeader(b);}else this.setSubHeader(null);}};
__d("ProfileBrowser",["ArbiterMixin","AsyncRequest","Class","CSS","Input","URI","$","copyProperties"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('AsyncRequest'),i=b('Class'),j=b('CSS'),k=b('Input'),l=b('URI'),m=b('$'),n=b('copyProperties');function o(){}n(o.prototype,g,{init:function(p,q,r,s,t){this.listView=p;this.target=q;this.selector=r;this.typeahead=s;this.hubs=t;this.subscribeListView();this.selector&&this.subscribeSelector();this.typeahead&&this.subscribeTypeahead();this.hubs&&this.subscribeHubs();},setSelectionLimit:function(p){this.selectionLimit=p;return this;},subscribeListView:function(){this.listView.subscribe('clickedCheckable',function(p,q){this.listView.toggleCheckableItem(q.item,!j.hasClass(q.item,'selectedCheckable'));}.bind(this));},subscribeSelector:function(){var p=this.typeahead&&this.typeahead.getCore();this.selector.subscribe('changeTarget',function(q,r){if(p){j.conditionShow(this.typeahead.getElement(),r.showtypeahead);p.getValue()&&p.reset();r.showtypeahead&&p.getElement().focus();}this.target=m(r.target);r.isprimer&&this.listView.setLoadingState(true);this.listView.swapList(this.target);this.hubs&&j.conditionShow(this.hubs.getElement(),r.hubs);}.bind(this));this.selector.subscribe('changeHub',function(q,r){var s=this.hubs.getCore(),t=s.getElement();this.hubs.init(this.hubBehaviors);this.hubs.swapData(this.hubsData[r.value]);s.reset();k.setPlaceholder(t,r.placeholder);t.focus();this.hubendpoint=l(r.endpoint);}.bind(this));},subscribeTypeahead:function(){this.typeahead.subscribe('render',function(){var p=this.typeahead.getCore().getValue()?this.typeahead.getView().element:this.target;this.listView.swapList(p);}.bind(this));this.typeahead.subscribe('reset',function(){this.listView.swapList(this.target);}.bind(this));this.typeahead.subscribe('loading',function(p,q){j.conditionClass(this.typeahead.getElement(),'loading',q.loading);}.bind(this));},subscribeHubs:function(){this.hubs.subscribe('select',function(p,q){this.hubendpoint.addQueryData({node:q.selected.uid,pagetext:q.selected.text,offset:0,target:this.target.id});j.addClass(this.hubs.getElement(),'hubsLoading');new h(this.hubendpoint).setReadOnly(true).setMethod('POST').setRelativeTo(this.selector.getSelectedAnchor()).setHandler(function(){j.removeClass(this.hubs.getElement(),'hubsLoading');}.bind(this)).send();}.bind(this));},addHubData:function(p){this.hubsData=n(this.hubsData,p);},addHubBehaviors:function(p){this.hubBehaviors=p;},getSelectionLimit:function(){return this.selectionLimit;}});e.exports=o;});
__d("legacy:ProfileBrowser",["ProfileBrowser"],function(a,b,c,d){a.ProfileBrowser=b('ProfileBrowser');},3);
__d("ProfileBrowserListView",["event-extensions","ArbiterMixin","Class","CSS","DOM","Parent","Vector","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');var g=b('ArbiterMixin'),h=b('Class'),i=b('CSS'),j=b('DOM'),k=b('Parent'),l=b('Vector'),m=b('copyProperties'),n=800;function o(){}m(o.prototype,g,{init:function(p,q,r){this._root=p;this._activeList=q;this._windowTrigger=r;Event.listen(p,'click',this._handleClick.bind(this));},resetScroll:function(){this._scroll&&this._scroll.remove();this._listenForScroll();},toggleCheckableItem:function(p,q){var r=j.find(p,'input.checkbox');r.checked=q;i.conditionClass(p,'selectedCheckable',q);var s=p.nextSibling||p.previousSibling;s&&i.addClass(s,'sib')&&i.removeClass(s,'sib');},setLoadingState:function(p){i.conditionClass(this._root,'showListviewLoading',p);},swapList:function(p){i.addClass(this._activeList,'hiddenList');this._activeList=p;i.show(this._activeList);i.removeClass(this._activeList,'hiddenList');},getRoot:function(){return this._root;},getActiveList:function(){return this._activeList;},setActiveList:function(p){this._activeList=p;return this;},_handleClick:function(event){var p=event.getTarget(),q=k.byClass(p,'checkableListItem');if(!q)return;var r=k.byClass(p,'anchor');if(!r&&k.byTag(p,'a'))return;if(!i.hasClass(q,'disabledCheckable')){r&&event.prevent();this.inform('clickedCheckable',{item:q});event.stop();}},_listenForScroll:function(){if(this._windowTrigger){this._rootHeight=l.getElementDimensions(this._root).y;if(this._rootHeight)this._scroll=Event.listen(window,'scroll',this._handleWindowScroll.bind(this));}else this._scroll=Event.listen(this._activeList,'scroll',this._handleListScroll.bind(this));},_handleWindowScroll:function(p){var q=this._rootHeight-l.getScrollPosition().y;if(q<=n)this.inform('scrollTrigger');},_handleListScroll:function(p){var q=p.getTarget(),r=q.scrollHeight-q.scrollTop;if(n>r)this.inform('scrollTrigger');}});e.exports=o;});
__d("ProfileBrowserSelector",["ArbiterMixin","Class","DOM","Selector","copyProperties"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('Class'),i=b('DOM'),j=b('Selector'),k=b('copyProperties');function l(){}k(l.prototype,g,{init:function(m){this.selector=m;j.listen(m,'select',this.handle.bind(this));},handle:function(m){var n=i.find(m.option,'a'),o=n.getAttribute('data-target'),p=n.getAttribute('data-selectendpoint'),q=j.getOptionValue(m.option);if(o)this.inform('changeTarget',{target:o,value:q,isprimer:n.getAttribute('rel')=='async',showtypeahead:n.getAttribute('data-typeahead'),hubs:!!p});if(p)this.inform('changeHub',{value:q,placeholder:n.getAttribute('data-placeholder'),endpoint:p});},getSelectedValue:function(){return j.getValue(this.selector);},getSelectedAnchor:function(){return i.find(j.getSelectedOptions(this.selector)[0],'a');},setSelectedValue:function(m){j.setSelected(this.selector,m,true);}});e.exports=l;});
__d("ProfileBrowserTypeaheadCore",["Class","TypeaheadCore","copyProperties"],function(a,b,c,d,e,f){var g=b('Class'),h=b('TypeaheadCore'),i=b('copyProperties');function j(k){this.parent.construct(this,k);}g.extend(j,h);i(j.prototype,{keepFocused:false,initToggle:bagofholding,select:bagofholding});e.exports=j;});
__d("ProfileBrowserTypeaheadView",["Class","copyProperties","DOM","tx","TypeaheadView"],function(a,b,c,d,e,f){var g=b('Class'),h=b('copyProperties'),i=b('DOM'),j=b('tx'),k=b('TypeaheadView');function l(m,n){this.parent.construct(this,m,n);}g.extend(l,k);h(l.prototype,{buildSummaryBox:function(m,n){var o;if(!n||!n.length){o=j._("Ei tuloksia haulla {search}.",{search:m});}else if(n.length==1){o=j._("1 tulos haulle: {search}",{search:m});}else o=j._("{count} tulosta haulle: {search}",{count:n.length,search:m});return i.create('div',{className:'fbProfileBrowserSummaryBox phs pvm'},[o]);},render:function(m,n){this.results=n;i.setContent(this.element,[this.buildSummaryBox(m,n),this.buildResults(n)]);this.items=this.getItems();this.inform('render',n);},click:bagofholding,buildResults:function(m){var n=i.create('div',{className:'fbProfileBrowserListContainer'},[i.create('div',{className:'fbProfileBrowserList'},[this.parent.buildResults(m)])]);return n;},renderer:function(m){var n=m.category||null,o;if(m.inactive){o=i.create('a',{href:'#',rel:'dialog',ajaxify:'/ajax/friends/inactive/dialog?id='+m.uid},m.text);}else o=i.create('a',{href:m.path},m.text);var p=i.create('li',{className:'fbProfileBrowserListItem uiListItem uiListLight uiListVerticalItemBorder'},[i.create('div',{className:'UIImageBlock clearfix UIImageBlock_Entity'},[i.create('a',{className:'UIImageBlock_Image UIImageBlock_ENT_Image',tabindex:-1,href:m.path},[i.create('img',{className:'img',src:m.photo})]),i.create('div',{className:'UIImageBlock_Content UIImageBlock_ENT_Content'},[i.create('div',{className:'fsl fwb fcb'},[o]),i.create('div',{className:'fsm fwn fcg'},[n])])])]);return p;}});e.exports=l;});
__d("SwitchableProfileBrowser",["Class","copyProperties","CSS","ProfileBrowser"],function(a,b,c,d,e,f){var g=b('Class'),h=b('copyProperties'),i=b('CSS'),j=b('ProfileBrowser');function k(){this.parent.construct(this);}g.extend(k,j);h(k.prototype,{NORMAL:'normal',LARGE:'large',GRID:'grid',initViewButtons:function(l,m){this.viewButtons=l;this.subscribeViewButtons();},subscribeTypeahead:function(){this.typeahead.subscribe('render',function(){if(this.typeahead.getCore().getValue()){this.listView.swapList(this.typeahead.getView().element);this.viewButtons.setEnabled(false);}else{this.listView.swapList(this.target);this.viewButtons.setEnabled(true);}}.bind(this));this.typeahead.subscribe('reset',function(){this.listView.swapList(this.target);this.viewButtons.setEnabled(true);}.bind(this));this.typeahead.subscribe('loading',function(l,m){i.conditionClass(this.typeahead.getElement(),'loading',m.loading);}.bind(this));},subscribeViewButtons:function(){this.viewButtons.subscribe('swapView',function(l,m){var n=this.typeahead&&this.typeahead.getCore();n&&n.getValue()&&n.reset();var o=this.listView.getRoot();i.conditionClass(o,this.NORMAL,m.view==this.NORMAL);i.conditionClass(o,this.LARGE,m.view==this.LARGE);i.conditionClass(o,this.GRID,m.view==this.GRID);}.bind(this));}});e.exports=k;});
__d("legacy:SwitchableProfileBrowser",["SwitchableProfileBrowser"],function(a,b,c,d){a.SwitchableProfileBrowser=b('SwitchableProfileBrowser');},3);
__d("ProfileBrowserViewButtons",["event-extensions","ArbiterMixin","Button","Class","CSS","DOM","Parent","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');var g=b('ArbiterMixin'),h=b('Button'),i=b('Class'),j=b('CSS'),k=b('DOM'),l=b('Parent'),m=b('copyProperties');function n(){}m(n.prototype,g,{init:function(o,p,q){this.root=o;this.buttons=k.scry(this.root,'.profileBrowserViewButton');this.searchView=q;this.selected=p;this.enabled=true;Event.listen(o,'click',this.handle.bind(this));},handle:function(event){if(!this.enabled)return;var o=event.getTarget(),p=l.byClass(o,'profileBrowserViewButton');if(j.hasClass(p,'uiButtonDepressed'))return;j.removeClass(this.selected,'uiButtonDepressed');this.selected=p;j.addClass(this.selected,'uiButtonDepressed');this.inform('swapView',{view:h.getInputElement(this.selected).name});},setEnabled:function(o){this.enabled=o;this.buttons.forEach(function(p){h.setEnabled(p,o);});}});e.exports=n;});
var GroupMemberSelector=function(){};GroupMemberSelector.prototype.init=function(a,b,c,d,e){this._form=a;this._search=b;this._viewFilter=c;this._groupURI=e;this._orderField=d;Selector.listen(c,'change',this.onFilter.bind(this));Event.listen(a,'submit',this.onSubmit.bind(this));b.removeAttribute('disabled');};GroupMemberSelector.prototype.onFilter=function(){this.onSubmit();};GroupMemberSelector.prototype.onSubmit=function(){var a=Selector.getValue(this._viewFilter)||'',b=a.split('-'),c=b[0]||null;this._orderField.value=b[1]||null;if(c=='admins'){this._form.action=this._groupURI+'admins/';}else if(c=='blocked'){this._form.action=this._groupURI+'blocked/';}else this._form.action=this._groupURI+'members/';this._form.view.disabled=true;if(this._search.value==this._search.placeholder)this._form.query.disabled=true;goURI(URI(this._form.action).setQueryData(Form.serialize(this._form)));return false;};